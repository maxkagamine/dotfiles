#!/bin/bash
#
# Copyright (c) Max Kagamine
# Licensed under the Apache License, Version 2.0
#
set -eo pipefail

if command -v recycle &>/dev/null; then
  rm() { recycle --rm "$@"; }
fi

if [[ ! -d muxed ]]; then
  echo 'No "muxed" directory from mkv-batch here' >&2
  exit 1
fi

mkv-ls muxed

echo
read -rp 'Accept changes? [Yn] ' yn
if [[ $yn == 'n' ]]; then
  exit
fi
echo

for f in muxed/*.mkv; do
  rm -fv "$(basename "$f" .mkv)"*.mkv # May have had a crc
  mv -v "$f" .
done

rmdir -v muxed
