#!/bin/bash

(
  while true; do
    socat UNIX-LISTEN:"$HOME/.ssh/agent.sock,unlink-close,unlink-early,fork" EXEC:"$HOME/.local/bin/wsl2-ssh-pageant.exe"
  done
) &

(
  while true; do
    socat UNIX-LISTEN:"$(gpgconf --list-dirs agent-socket),unlink-close,unlink-early,fork" EXEC:"$HOME/.local/bin/wsl2-ssh-pageant.exe --gpg S.gpg-agent"
  done
) &

wait
